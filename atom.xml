<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Huanzの小窝</title>
  
  <subtitle>大世界，它耀眼吗</subtitle>
  <link href="https://huanz.top/atom.xml" rel="self"/>
  
  <link href="https://huanz.top/"/>
  <updated>2021-11-14T10:54:17.000Z</updated>
  <id>https://huanz.top/</id>
  
  <author>
    <name>Huanz</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>51 单片机实验（C 语言）</title>
    <link href="https://huanz.top/2021/89C51/"/>
    <id>https://huanz.top/2021/89C51/</id>
    <published>2021-11-14T10:54:17.000Z</published>
    <updated>2021-11-14T10:54:17.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这学期我开了 51 单片机的课，之后会将我的一些作业发自己网站上，希望能有用。我使用的开发板核心是 STC12C5A16S2，理论上以下代码是适用于 8051 内核单片机。</p></blockquote><span id="more"></span><h1 id="实验 1- 利用数码管显示数字"><a href="# 实验 1- 利用数码管显示数字" class="headerlink" title="实验 1 利用数码管显示数字"></a>实验 1 利用数码管显示数字 </h1><p> 本实验利用“共阳数码管”显示一串数字，利用中断方式每隔 1 秒更换一个数字。</p><p>代码如下，对其中的一些语句做出了标注。</p><p>说明：我所用的 STC 实验板中，p21 是“4 位共阳数码管”的第一位数字的控制引脚，P0 是数码管的公共极。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数码管显示数字</span></span><br><span class="line"><span class="comment">//#include&quot;head.h&quot;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line">sbit P21=P2^<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line"><span class="comment">//int led[11]=&#123;0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,0x7F,0x6F&#125;;// 共阴 0~9</span></span><br><span class="line"><span class="keyword">int</span> led[<span class="number">11</span>]=&#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;;<span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="keyword">int</span> num[<span class="number">13</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> counter=<span class="number">0</span>;<span class="comment">// 更换的数字</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">P21=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">TMOD=<span class="number">0x01</span>;<span class="comment">//50ms</span></span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line"></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">// 中断总开关</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">//T0 中断子开关</span></span><br><span class="line">TF0=<span class="number">0</span>;<span class="comment">//T0 溢出标志置 0</span></span><br><span class="line">TR0=<span class="number">1</span>;<span class="comment">// 打开计时器</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// 清除中断标志</span></span><br><span class="line">TH0=<span class="number">0x3c</span>;</span><br><span class="line">TL0=<span class="number">0xb0</span>;</span><br><span class="line"><span class="comment">// 进行 1s 的计数</span></span><br><span class="line">counter++;</span><br><span class="line"><span class="keyword">if</span>(counter==<span class="number">20</span>)</span><br><span class="line">&#123;</span><br><span class="line">counter=<span class="number">0</span>;</span><br><span class="line">i=num[j++];</span><br><span class="line">P0=led[i];</span><br><span class="line"><span class="keyword">if</span>(j&gt;=<span class="number">9</span>) j=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="实验 2- 数码管显示脉冲的时间（计数器）"><a href="# 实验 2- 数码管显示脉冲的时间（计数器）" class="headerlink" title="实验 2 数码管显示脉冲的时间（计数器）"></a>实验 2 数码管显示脉冲的时间（计数器）</h1><p>本实验利用“共阳数码管”显示测量脉冲的时间（ms），而这个脉冲由按键产生。</p><p>代码如下，对其中的一些语句做出了标注。</p><p>说明：我所用的 STC 实验板中，p21-p24 是“4 位共阳数码管”的第一位数字的控制引脚，P0 是数码管的公共极；p32 是按键引脚，按下是高电平。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line">sbit p21=P2^<span class="number">1</span>;sbit p22=P2^<span class="number">2</span>;sbit p23=P2^<span class="number">3</span>;sbit p24=P2^<span class="number">4</span>;</span><br><span class="line">sbit p32=P3^<span class="number">2</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> led[<span class="number">12</span>]=&#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;;<span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> n=<span class="number">0</span>,s=<span class="number">0</span>,i=<span class="number">0</span>,qian=<span class="number">0</span>,bai=<span class="number">0</span>,shi=<span class="number">0</span>,ge=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">(<span class="keyword">int</span> z)</span><span class="comment">// 延时函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=z;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">921</span>;j++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TMOD=<span class="number">0x01</span>;</span><br><span class="line">TH0=<span class="number">0x00</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0x00</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line"></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">// 中断总开关</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">//T0 定时器中断子开关</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(p32==<span class="number">1</span>)&#123;delay(<span class="number">20</span>);&#125;</span><br><span class="line">TR0=<span class="number">1</span>;                              <span class="comment">// 打开计时器</span></span><br><span class="line"><span class="keyword">while</span>(p32==<span class="number">0</span>)&#123;delay(<span class="number">20</span>);&#125;          <span class="comment">// 等待电平由低变高</span></span><br><span class="line"><span class="keyword">while</span>(p32==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">s=(n*<span class="number">65536</span>+TH0*<span class="number">256</span>+TL0)/<span class="number">1000</span>;</span><br><span class="line">qian=s/<span class="number">1000</span>%<span class="number">10</span>;</span><br><span class="line">bai=s/<span class="number">100</span>%<span class="number">10</span>;</span><br><span class="line">shi=s/<span class="number">10</span>%<span class="number">10</span>;</span><br><span class="line">ge=s%<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:P0=<span class="number">0xff</span>;p21=<span class="number">0</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[qian];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">0</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[bai];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">0</span>;p24=<span class="number">1</span>;P0=led[shi];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">0</span>;P0=led[ge];i=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;                      <span class="comment">// 等待电平由高变低</span></span><br><span class="line">TR0=<span class="number">0</span>;                              <span class="comment">// 关闭计时器</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(i) <span class="comment">// 同上</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:P0=<span class="number">0xff</span>;p21=<span class="number">0</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[qian];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">0</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[bai];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">0</span>;p24=<span class="number">0</span>;P0=led[shi];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[ge];i=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1 <span class="keyword">using</span> 0</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n++;</span><br><span class="line">TH0=<span class="number">0x00</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0x00</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="实验 3- 检测按键次数（计数器）"><a href="# 实验 3- 检测按键次数（计数器）" class="headerlink" title="实验 3 检测按键次数（计数器）"></a>实验 3 检测按键次数（计数器）</h1><p>本实验利用“共阳数码管”显示测量脉冲的次数，脉冲由按键产生。</p><p>说明：我所用的 STC 实验板中，p21-p24 是“4 位共阳数码管”的第一位数字的控制引脚，P0 是数码管的公共极；p34 是按键引脚，按下是高电平。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P32 按键外部中断启动计时</span></span><br><span class="line"><span class="comment">// 检测 p34 在 1s 内共按的次数，显示在数码管上</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;reg51.h&quot;</span></span></span><br><span class="line">sbit p21=P2^<span class="number">1</span>;sbit p22=P2^<span class="number">2</span>;sbit p23=P2^<span class="number">3</span>;sbit p24=P2^<span class="number">4</span>;</span><br><span class="line">sbit p32=P3^<span class="number">2</span>;sbit p33=P3^<span class="number">3</span>;sbit p34=P3^<span class="number">4</span>;sbit p35=P3^<span class="number">5</span>;</span><br><span class="line">sbit p37=P3^<span class="number">7</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> led[<span class="number">12</span>]=&#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;;<span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="keyword">int</span> n=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TMOD=<span class="number">0x51</span>;<span class="comment">//0101 0001 T1 计数 T0 计时</span></span><br><span class="line">TH1=<span class="number">0</span>;</span><br><span class="line">TL1=<span class="number">0</span>;</span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">//50ms</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;</span><br><span class="line"></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">// 中断允许</span></span><br><span class="line">ET1=<span class="number">1</span>;<span class="comment">// 中断允许</span></span><br><span class="line">TF0=<span class="number">0</span>;<span class="comment">// 溢出标志位清 0</span></span><br><span class="line">EA=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(INT0==<span class="number">1</span>);<span class="comment">// 未按 p32</span></span><br><span class="line"></span><br><span class="line">TR0=<span class="number">1</span>;<span class="comment">// 打开 T0</span></span><br><span class="line">TR1=<span class="number">1</span>;<span class="comment">// 打开 T1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">num=TH1*<span class="number">256</span>+TL1;</span><br><span class="line">p21=<span class="number">0</span>;</span><br><span class="line">P0=led[num];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1 <span class="keyword">using</span> 0</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line">n++;</span><br><span class="line"><span class="keyword">if</span>(n==<span class="number">20</span>)</span><br><span class="line">&#123;</span><br><span class="line">TR1=<span class="number">0</span>;<span class="comment">// 关闭 T1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="实验 4- 按键的短按长按"><a href="# 实验 4- 按键的短按长按" class="headerlink" title="实验 4 按键的短按长按"></a>实验 4 按键的短按长按 </h1><p> 实验目的：体会外部中断的边沿触发和电平触发。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实验 4 按键的短按长按</span></span><br><span class="line"><span class="comment">//T0 外部中断 p32 长按计时 数码管快加 1 </span></span><br><span class="line"><span class="comment">//T1 外部中断 p33 短按  数码管慢加 1 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line">sbit p21=P2^<span class="number">1</span>;</span><br><span class="line">sbit p22=P2^<span class="number">2</span>;</span><br><span class="line">sbit p23=P2^<span class="number">3</span>;</span><br><span class="line">sbit p24=P2^<span class="number">4</span>;</span><br><span class="line"><span class="keyword">int</span> num=<span class="number">0</span>,n=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> i=<span class="number">0</span>,ge=<span class="number">0</span>,shi=<span class="number">0</span>,bai=<span class="number">0</span>,qian=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> led[<span class="number">12</span>]=&#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;;<span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TMOD=<span class="number">0x01</span>;</span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line">IT0=<span class="number">0</span>;<span class="comment">// 外部中断电平触发 // 长按</span></span><br><span class="line">IT1=<span class="number">1</span>;<span class="comment">// 外部中断边沿触发 // 短按</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">// 定时器 0 中断允许位 //T0 定时器中断子开关</span></span><br><span class="line">ET1=<span class="number">1</span>;</span><br><span class="line">EX0=<span class="number">1</span>;<span class="comment">// 外部中断 INT0 开关</span></span><br><span class="line">EX1=<span class="number">1</span>;</span><br><span class="line">PT0=<span class="number">1</span>;<span class="comment">// 定时器提升优先级</span></span><br><span class="line"><span class="comment">//PT1=1;</span></span><br><span class="line"><span class="comment">//PX0=1;// 外部中断提高优先级</span></span><br><span class="line"><span class="comment">//PX1=1;</span></span><br><span class="line">EA=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">qian=num/<span class="number">1000</span>%<span class="number">10</span>;</span><br><span class="line">bai=num/<span class="number">100</span>%<span class="number">10</span>;</span><br><span class="line">shi=num/<span class="number">10</span>%<span class="number">10</span>;</span><br><span class="line">ge=num%<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:P0=<span class="number">0xff</span>;p21=<span class="number">0</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[qian];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">0</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[bai];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">0</span>;p24=<span class="number">1</span>;P0=led[shi];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">0</span>;P0=led[ge];i=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IN0</span><span class="params">()</span> interrupt 0</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TR0=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n++;</span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line"><span class="keyword">if</span>(n==<span class="number">4</span>) <span class="comment">// 计时 200ms, 实现快加 1</span></span><br><span class="line">&#123;</span><br><span class="line">num++;</span><br><span class="line">n=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(INT0==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">TR0=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IN1</span><span class="params">()</span> interrupt 2</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">num++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="实验 4- 按键设置倒计时"><a href="# 实验 4- 按键设置倒计时" class="headerlink" title="实验 4% 按键设置倒计时"></a>实验 4% 按键设置倒计时 </h1><p> 实验目的：设计一个可以自定时间的倒计时器。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实验 4% 利用按键设置倒计时</span></span><br><span class="line"><span class="comment">// 按键计数设置时间，外部中断实现按下开始倒计时，倒计时完毕小灯点亮或蜂鸣器响</span></span><br><span class="line"><span class="comment">//T0 外部中断设置时间，T1 外部中断开始倒计时</span></span><br><span class="line"><span class="comment">//T0 作为计时器</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line">sbit p21=P2^<span class="number">1</span>;</span><br><span class="line">sbit p22=P2^<span class="number">2</span>;</span><br><span class="line">sbit p23=P2^<span class="number">3</span>;</span><br><span class="line">sbit p24=P2^<span class="number">4</span>;</span><br><span class="line">sbit p37=P3^<span class="number">7</span>;<span class="comment">// 蜂鸣器</span></span><br><span class="line"><span class="keyword">int</span> Time=<span class="number">0</span>,n=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> i=<span class="number">0</span>,ge=<span class="number">0</span>,shi=<span class="number">0</span>,bai=<span class="number">0</span>,qian=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> led[<span class="number">12</span>]=&#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;;<span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">(<span class="keyword">int</span> z)</span><span class="comment">// 延时函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=z;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">921</span>;j++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TMOD=<span class="number">0x01</span>;</span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line">IT0=<span class="number">1</span>;</span><br><span class="line">IT1=<span class="number">1</span>;<span class="comment">// 外部中断边沿触发 // 短按</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">// 定时器 0 中断允许位 //T0 定时器中断子开关</span></span><br><span class="line">ET1=<span class="number">1</span>;</span><br><span class="line">EX0=<span class="number">1</span>;<span class="comment">// 外部中断 INT0 开关</span></span><br><span class="line">EX1=<span class="number">1</span>;</span><br><span class="line">EA=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">qian=Time/<span class="number">1000</span>%<span class="number">10</span>;</span><br><span class="line">bai=Time/<span class="number">100</span>%<span class="number">10</span>;</span><br><span class="line">shi=Time/<span class="number">10</span>%<span class="number">10</span>;</span><br><span class="line">ge=Time%<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:P0=<span class="number">0xff</span>;p21=<span class="number">0</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[qian];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">0</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[bai];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">0</span>;p24=<span class="number">1</span>;P0=led[shi];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">0</span>;P0=led[ge];i=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IN0</span><span class="params">()</span> interrupt 0</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Time++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n++;</span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line"><span class="keyword">if</span>(n==<span class="number">20</span>) <span class="comment">// 计时 200ms, 实现快加 1</span></span><br><span class="line">&#123;</span><br><span class="line">Time--;</span><br><span class="line">n=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(Time==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">p37=<span class="number">1</span>;</span><br><span class="line">delay(<span class="number">200</span>);</span><br><span class="line">p37=<span class="number">0</span>;</span><br><span class="line">delay(<span class="number">20000</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IN1</span><span class="params">()</span> interrupt 2</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TR0=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="实验 5- 串口通信"><a href="# 实验 5- 串口通信" class="headerlink" title="实验 5 串口通信"></a>实验 5 串口通信 </h1><p> 实验目的：初步接触串口通信，单片机接收电脑发来的数据，用数码管显示，并发送回电脑。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单片机接收电脑发来的数据，用数码管显示，再发送回电脑</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line">sbit p21=P2^<span class="number">1</span>;</span><br><span class="line">sbit p22=P2^<span class="number">2</span>;</span><br><span class="line">sbit p23=P2^<span class="number">3</span>;</span><br><span class="line">sbit p24=P2^<span class="number">4</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> led[<span class="number">12</span>]= &#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;; <span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> num=<span class="number">0</span>,i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ch[<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">SCON=<span class="number">0X50</span>;<span class="comment">// 选择方式 1；允许接受数据；</span></span><br><span class="line">TMOD=<span class="number">0X20</span>;<span class="comment">// 选 T1 为方式 2：自动重装的 8 位计时器</span></span><br><span class="line">TH1=TL1=<span class="number">0XF3</span>;<span class="comment">//f=2400~12MHz (9600~B11.0592-0xFD)</span></span><br><span class="line"></span><br><span class="line">TR1=<span class="number">1</span>;<span class="comment">// 打开计时器</span></span><br><span class="line">ES=<span class="number">1</span>;<span class="comment">// 串口中断允许</span></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">// 中断总开关</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">num=SBUF;</span><br><span class="line">ch[<span class="number">0</span>]=num/<span class="number">16</span>%<span class="number">16</span>;</span><br><span class="line">ch[<span class="number">1</span>]=num%<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(i) &#123; <span class="comment">// 同上</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">P0=<span class="number">0xff</span>;</span><br><span class="line">p21=<span class="number">0</span>;</span><br><span class="line">p22=<span class="number">1</span>;</span><br><span class="line">p23=<span class="number">1</span>;</span><br><span class="line">p24=<span class="number">1</span>;</span><br><span class="line">P0=led[ch[<span class="number">0</span>]];</span><br><span class="line">i++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">P0=<span class="number">0xff</span>;</span><br><span class="line">p21=<span class="number">1</span>;</span><br><span class="line">p22=<span class="number">0</span>;</span><br><span class="line">p23=<span class="number">1</span>;</span><br><span class="line">p24=<span class="number">1</span>;</span><br><span class="line">P0=led[ch[<span class="number">1</span>]];</span><br><span class="line">i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">serial</span><span class="params">()</span> interrupt 4 </span>&#123; <span class="comment">// 串行口中断</span></span><br><span class="line"><span class="keyword">if</span>(TI==<span class="number">1</span>) &#123; <span class="comment">// 发送</span></span><br><span class="line">TI=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(RI==<span class="number">1</span>) &#123;<span class="comment">// 接收</span></span><br><span class="line">RI=<span class="number">0</span>;</span><br><span class="line">SBUF=SBUF;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="实验 6- 检测脉冲 - 串口显示"><a href="# 实验 6- 检测脉冲 - 串口显示" class="headerlink" title="实验 6 检测脉冲 串口显示"></a>实验 6 检测脉冲 串口显示 </h1><p> 实验目的：实验 2 和 5 的结合。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单片机检测 高电平时间或低电平时间或周期时间</span></span><br><span class="line"><span class="comment">// 结果发送电脑串口显示</span></span><br><span class="line"><span class="comment">// T0 用作计时器</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line">sbit p21=P2^<span class="number">1</span>;</span><br><span class="line">sbit p32=P3^<span class="number">2</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> led[<span class="number">12</span>]= &#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;; <span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> n=<span class="number">0</span>,s=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">(<span class="keyword">int</span> z)</span> </span>&#123; <span class="comment">// 延时函数</span></span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=z; i&gt;<span class="number">0</span>; i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">921</span>; j++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">SCON=<span class="number">0X50</span>;<span class="comment">// 选择方式 1；允许接受数据；</span></span><br><span class="line">TMOD=<span class="number">0X21</span>;<span class="comment">// 选 T1 为方式 2：自动重装的 8 位计时器 T0 做计时器，测量按键（脉冲）一个周期</span></span><br><span class="line"><span class="comment">//TMOD=0X29;//T0 做计时器，测量按键 p32 高电平</span></span><br><span class="line">TH0=<span class="number">0x00</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0x00</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line">TH1=TL1=<span class="number">0XF3</span>;<span class="comment">//f=2400~12MHz (9600~B11.0592-0xFD)</span></span><br><span class="line"></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">// 中断总开关</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">//T0 中断子开关</span></span><br><span class="line">TR1=<span class="number">1</span>;<span class="comment">// 打开 T1 计时器</span></span><br><span class="line">ES=<span class="number">1</span>;<span class="comment">// 串口中断允许</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(p32==<span class="number">1</span>);</span><br><span class="line">TR0=<span class="number">1</span>;                              <span class="comment">// 打开计时器</span></span><br><span class="line"><span class="keyword">while</span>(p32==<span class="number">0</span>) &#123;</span><br><span class="line">delay(<span class="number">5</span>);   <span class="comment">// 等待电平由低变高</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p32==<span class="number">1</span>);                      <span class="comment">// 等待电平由高变低</span></span><br><span class="line">TR0=<span class="number">0</span>;                              <span class="comment">// 关闭计时器</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s=((n*<span class="number">65536</span>+TH0*<span class="number">256</span>+TL0)/<span class="number">1000000</span>)%<span class="number">10</span>;</span><br><span class="line">p21=<span class="number">0</span>;</span><br><span class="line">P0=led[s];</span><br><span class="line">SBUF=s;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1 </span>&#123;</span><br><span class="line">n++;</span><br><span class="line">TH0=<span class="number">0x00</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0x00</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">serial</span><span class="params">()</span> interrupt 4 </span>&#123; <span class="comment">// 串行口中断</span></span><br><span class="line"><span class="keyword">if</span>(TI==<span class="number">1</span>) &#123; <span class="comment">// 发送</span></span><br><span class="line">TI=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(RI==<span class="number">1</span>) &#123;<span class="comment">// 接收</span></span><br><span class="line">RI=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="实验 6- 电子琴"><a href="# 实验 6- 电子琴" class="headerlink" title="实验 6% 电子琴"></a>实验 6% 电子琴 </h1><p> 实验目的：利用中断模拟出蜂鸣器的不同音调的声音。</p><p>说明：我所用的 STC 实验板中，使用 12MHz 晶振，p37 是蜂鸣器控制引脚。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单片机  电子琴</span></span><br><span class="line"><span class="comment">//T1 做串口定时器</span></span><br><span class="line"><span class="comment">//T0 做蜂鸣器的定时中断</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line">sbit p37=P3^<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> receive=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> n=<span class="number">0</span>,s=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> T0RH = <span class="number">0xFF</span>; <span class="comment">//T0 重载值的高字节</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> T0RL = <span class="number">0x00</span>; <span class="comment">//T0 重载值的低字节</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> code NoteReload[] = &#123; <span class="comment">// 中音 1-7 和高音 1-7 对应的定时器重载值</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">523</span>*<span class="number">2</span>), <span class="comment">// 中音 1</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">587</span>*<span class="number">2</span>), <span class="comment">//2</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">659</span>*<span class="number">2</span>), <span class="comment">//3</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">698</span>*<span class="number">2</span>), <span class="comment">//4</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">784</span>*<span class="number">2</span>), <span class="comment">//5</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">880</span>*<span class="number">2</span>), <span class="comment">//6</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">988</span>*<span class="number">2</span>), <span class="comment">//7</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1047</span>*<span class="number">2</span>), <span class="comment">// 高音 1</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1175</span>*<span class="number">2</span>), <span class="comment">//2</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1319</span>*<span class="number">2</span>), <span class="comment">//3</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1397</span>*<span class="number">2</span>), <span class="comment">//4</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1568</span>*<span class="number">2</span>), <span class="comment">//5</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1760</span>*<span class="number">2</span>), <span class="comment">//6</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1976</span>*<span class="number">2</span>), <span class="comment">//7</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">(<span class="keyword">int</span> z)</span> </span>&#123; <span class="comment">// 延时函数</span></span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=z; i&gt;<span class="number">0</span>; i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">921</span>; j++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">SCON=<span class="number">0X50</span>;<span class="comment">// 选择方式 1；允许接受数据；</span></span><br><span class="line">TMOD=<span class="number">0X21</span>;<span class="comment">// 选 T1 为方式 2：自动重装的 8 位计时器 T0 做计时器，测量按键（脉冲）一个周期</span></span><br><span class="line"><span class="comment">//TMOD=0X29;//T0 做计时器，测量按键 p32 高电平</span></span><br><span class="line">TH0 = T0RH;</span><br><span class="line">TL0 = T0RL;</span><br><span class="line">TH1=TL1=<span class="number">0XF3</span>;<span class="comment">//f=2400~12MHz (9600~B11.0592-0xFD)</span></span><br><span class="line"></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">// 中断总开关</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">//T0 中断子开关</span></span><br><span class="line">TR0=<span class="number">1</span>;</span><br><span class="line">TR1=<span class="number">1</span>;<span class="comment">// 打开 T1 计时器</span></span><br><span class="line">ES=<span class="number">1</span>;<span class="comment">// 串口中断允许</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">T0RH = NoteReload[receive] &gt;&gt; <span class="number">8</span>;</span><br><span class="line">T0RL = NoteReload[receive];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1 </span>&#123;</span><br><span class="line">p37 = ~p37;</span><br><span class="line">TH0 = T0RH;</span><br><span class="line">TL0 = T0RL;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">serial</span><span class="params">()</span> interrupt 4 </span>&#123; <span class="comment">// 串行口中断</span></span><br><span class="line"><span class="keyword">if</span>(TI==<span class="number">1</span>) &#123; <span class="comment">// 发送</span></span><br><span class="line">TI=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(RI==<span class="number">1</span>) &#123;<span class="comment">// 接收</span></span><br><span class="line">RI=<span class="number">0</span>;</span><br><span class="line">receive=SBUF;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下是我找的一个例程，可以播放出《两只老虎》。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/********* 两只老虎 例程 ***********/</span></span><br><span class="line"><span class="comment">/*** 摘自《手把手教你学 51 单片机 -C 语言版》*/</span></span><br><span class="line"><span class="comment">/* 由金沙滩工作室宋雪松老师等人员编著、由清华大学出版社出版的单片机学习教材 */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;reg52.h&gt;</span></span></span><br><span class="line">sbit BUZZ = P3^<span class="number">7</span>; <span class="comment">// 蜂鸣器控制引脚</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> code NoteFrequ[] = &#123; <span class="comment">// 中音 1-7 和高音 1-7 对应频率列表</span></span><br><span class="line"><span class="number">523</span>, <span class="number">587</span>, <span class="number">659</span>, <span class="number">698</span>, <span class="number">784</span>, <span class="number">880</span>, <span class="number">988</span>, <span class="comment">// 中音 1-7</span></span><br><span class="line"><span class="number">1047</span>, <span class="number">1175</span>, <span class="number">1319</span>, <span class="number">1397</span>, <span class="number">1568</span>, <span class="number">1760</span>, <span class="number">1976</span> <span class="comment">// 高音 1-7</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> code NoteReload[] = &#123; <span class="comment">// 中音 1-7 和高音 1-7 对应的定时器重载值</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">523</span>*<span class="number">2</span>), <span class="comment">// 中音 1</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">587</span>*<span class="number">2</span>), <span class="comment">//2</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">659</span>*<span class="number">2</span>), <span class="comment">//3</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">698</span>*<span class="number">2</span>), <span class="comment">//4</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">784</span>*<span class="number">2</span>), <span class="comment">//5</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">880</span>*<span class="number">2</span>), <span class="comment">//6</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">988</span>*<span class="number">2</span>), <span class="comment">//7</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1047</span>*<span class="number">2</span>), <span class="comment">// 高音 1</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1175</span>*<span class="number">2</span>), <span class="comment">//2</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1319</span>*<span class="number">2</span>), <span class="comment">//3</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1397</span>*<span class="number">2</span>), <span class="comment">//4</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1568</span>*<span class="number">2</span>), <span class="comment">//5</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1760</span>*<span class="number">2</span>), <span class="comment">//6</span></span><br><span class="line"><span class="number">65536</span> - (<span class="number">12000000</span>/<span class="number">12</span>) / (<span class="number">1976</span>*<span class="number">2</span>), <span class="comment">//7</span></span><br><span class="line">&#125;;</span><br><span class="line">bit enable = <span class="number">1</span>; <span class="comment">// 蜂鸣器发声使能标志</span></span><br><span class="line">bit tmrflag = <span class="number">0</span>; <span class="comment">// 定时器中断完成标志</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> T0RH = <span class="number">0xFF</span>; <span class="comment">//T0 重载值的高字节</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> T0RL = <span class="number">0x00</span>; <span class="comment">//T0 重载值的低字节</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PlayTwoTiger</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">EA = <span class="number">1</span>; <span class="comment">// 使能全局中断</span></span><br><span class="line">TMOD = <span class="number">0x01</span>; <span class="comment">// 配置 T0 工作在模式 1</span></span><br><span class="line">TH0 = T0RH;</span><br><span class="line">TL0 = T0RL;</span><br><span class="line">ET0 = <span class="number">1</span>; <span class="comment">// 使能 T0 中断</span></span><br><span class="line">TR0 = <span class="number">1</span>; <span class="comment">// 启动 T0</span></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">PlayTwoTiger(); <span class="comment">// 播放乐曲 -- 两支老虎</span></span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">40000</span>; i++); <span class="comment">// 停止一段时间</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 两支老虎乐曲播放函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PlayTwoTiger</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> beat; <span class="comment">// 当前节拍索引</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> note; <span class="comment">// 当前节拍对应的音符</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> time = <span class="number">0</span>; <span class="comment">// 当前节拍计时</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> beatTime = <span class="number">0</span>; <span class="comment">// 当前节拍总时间</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> soundTime = <span class="number">0</span>; <span class="comment">// 当前节拍需发声时间</span></span><br><span class="line"><span class="comment">// 两只老虎音符表</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> code TwoTigerNote[] = &#123;</span><br><span class="line"><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line"><span class="number">5</span>,<span class="number">6</span>, <span class="number">5</span>,<span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>,<span class="number">6</span>, <span class="number">5</span>,<span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 两只老虎节拍表，4 表示一拍，1 就是 1/4 拍，8 就是 2 拍</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> code TwoTigerBeat[] = &#123;</span><br><span class="line"><span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>,</span><br><span class="line"><span class="number">3</span>,<span class="number">1</span>, <span class="number">3</span>,<span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>,<span class="number">1</span>, <span class="number">3</span>,<span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (beat=<span class="number">0</span>; beat&lt;<span class="keyword">sizeof</span>(TwoTigerNote); ) &#123; <span class="comment">// 用节拍索引作为循环变量</span></span><br><span class="line"><span class="keyword">while</span> (!tmrflag); <span class="comment">// 每次定时器中断完成后，检测并处理节拍</span></span><br><span class="line">tmrflag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (time == <span class="number">0</span>) &#123; <span class="comment">// 当前节拍播完则启动一个新节拍</span></span><br><span class="line">note = TwoTigerNote[beat] - <span class="number">1</span>;</span><br><span class="line">T0RH = NoteReload[note] &gt;&gt; <span class="number">8</span>;</span><br><span class="line">T0RL = NoteReload[note];</span><br><span class="line"><span class="comment">// 计算节拍总时间，右移 2 位相当于除 4，移位代替除法可以加快执行速度</span></span><br><span class="line">beatTime = (TwoTigerBeat[beat] * NoteFrequ[note]) &gt;&gt; <span class="number">2</span>;</span><br><span class="line"><span class="comment">// 计算发声时间，为总时间的 0.75，移位原理同上</span></span><br><span class="line">soundTime = beatTime - (beatTime &gt;&gt; <span class="number">2</span>);</span><br><span class="line">enable = <span class="number">1</span>; <span class="comment">// 指示蜂鸣器开始发声</span></span><br><span class="line">time++;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment">// 当前节拍未播完则处理当前节拍</span></span><br><span class="line"><span class="keyword">if</span> (time &gt;= beatTime) &#123; <span class="comment">// 当前持续时间到达节拍总时间时归零，</span></span><br><span class="line"><span class="comment">// 并递增节拍索引，以准备启动新节拍</span></span><br><span class="line">time = <span class="number">0</span>;</span><br><span class="line">beat++;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment">// 当前持续时间未达到总时间时，</span></span><br><span class="line">time++; <span class="comment">// 累加时间计数</span></span><br><span class="line"><span class="keyword">if</span> (time == soundTime) &#123; <span class="comment">// 到达发声时间后，指示关闭蜂鸣器，</span></span><br><span class="line"><span class="comment">// 插入 0.25* 总时间的静音间隔，</span></span><br><span class="line">enable = <span class="number">0</span>; <span class="comment">// 用以区分连续的两个节拍</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// T0 中断服务函数，用于控制蜂鸣器发声</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InterruptTimer0</span><span class="params">()</span> interrupt 1 </span>&#123;</span><br><span class="line">TH0 = T0RH; <span class="comment">// 重新加载重载值</span></span><br><span class="line">TL0 = T0RL;</span><br><span class="line">tmrflag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (enable) <span class="comment">// 使能时反转蜂鸣器控制电平</span></span><br><span class="line">BUZZ = ~BUZZ;</span><br><span class="line"><span class="keyword">else</span> <span class="comment">// 未使能时关闭蜂鸣器</span></span><br><span class="line">BUZZ = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="实验 7- 串口收数据 - 倒计数亮灯"><a href="# 实验 7- 串口收数据 - 倒计数亮灯" class="headerlink" title="实验 7 串口收数据 倒计数亮灯"></a>实验 7 串口收数据 倒计数亮灯 </h1><p> 实验目的：实验 6 拓展。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实验 7 串口收数据 倒数亮灯</span></span><br><span class="line"><span class="comment">// 单片机接受数字（c 串口）</span></span><br><span class="line"><span class="comment">// T0 用作外部中断</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line">sbit p20=P2^<span class="number">0</span>;</span><br><span class="line">sbit p21=P2^<span class="number">1</span>;</span><br><span class="line">sbit p32=P3^<span class="number">2</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> led[<span class="number">12</span>]= &#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;; <span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line">bit flag=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">SCON=<span class="number">0X50</span>;<span class="comment">// 选择方式 1；允许接受数据；</span></span><br><span class="line">TMOD=<span class="number">0X21</span>;</span><br><span class="line">TH1=TL1=<span class="number">0XF3</span>;<span class="comment">//f=2400~12MHz (9600~B11.0592-0xFD)</span></span><br><span class="line"></span><br><span class="line">IT0=<span class="number">1</span>;<span class="comment">// 外部中断边沿触发 // 短按</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">// 定时器 0 中断允许位 //T0 定时器中断子开关</span></span><br><span class="line">EX0=<span class="number">1</span>;<span class="comment">// 外部中断 INT0 开关</span></span><br><span class="line"></span><br><span class="line">TR1=<span class="number">1</span>;<span class="comment">// 打开 T1 计时器</span></span><br><span class="line">ES=<span class="number">1</span>;<span class="comment">// 串口中断允许</span></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">// 中断总开关</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">p21=<span class="number">0</span>;</span><br><span class="line">P0=led[num];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(num&lt;=<span class="number">0</span> &amp;&amp; flag==<span class="number">1</span>) &#123;</span><br><span class="line">p20=<span class="number">0</span>;</span><br><span class="line">P0=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IN0</span><span class="params">()</span> interrupt 0 </span>&#123;</span><br><span class="line">num--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">serial</span><span class="params">()</span> interrupt 4 </span>&#123; <span class="comment">// 串行口中断</span></span><br><span class="line"><span class="keyword">if</span>(RI==<span class="number">1</span>) &#123;<span class="comment">// 接收</span></span><br><span class="line">RI=<span class="number">0</span>;</span><br><span class="line">num=SBUF;</span><br><span class="line">flag=<span class="number">1</span>;</span><br><span class="line">TR1=<span class="number">0</span>;<span class="comment">// 关闭 T1 计时器</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="实验 8- 电子表"><a href="# 实验 8- 电子表" class="headerlink" title="实验 8 电子表"></a>实验 8 电子表 </h1><p> 实验目的：使用 4 个数码管的前两位表示小时，后两位表示分钟。使用 3 个按键对电子表进行调节，其中 p32 更换调节位，p33 加 1，p34 减 1。</p><p>难点：按键消抖；时间的进位（小时最大 24，分钟最大 60）。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg51.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;intrins.h&gt;</span></span></span><br><span class="line"><span class="comment">// 实验 8 电子表</span></span><br><span class="line"><span class="comment">//T0 作 1s 计时</span></span><br><span class="line">sbit p21=P2^<span class="number">1</span>;</span><br><span class="line">sbit p22=P2^<span class="number">2</span>;</span><br><span class="line">sbit p23=P2^<span class="number">3</span>;</span><br><span class="line">sbit p24=P2^<span class="number">4</span>;</span><br><span class="line">sbit p32=P3^<span class="number">2</span>;<span class="comment">// 选择键</span></span><br><span class="line">sbit p33=P3^<span class="number">3</span>;<span class="comment">// 增加键 +1</span></span><br><span class="line">sbit p34=P3^<span class="number">4</span>;<span class="comment">// 减小键 -1</span></span><br><span class="line"><span class="keyword">int</span> hour=<span class="number">0</span>,minute=<span class="number">0</span>;<span class="comment">// 前小时，后分钟</span></span><br><span class="line"><span class="keyword">int</span> num[<span class="number">4</span>]= &#123;<span class="number">0</span>&#125;; <span class="comment">// 前两位小时，后两位分钟</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> led[<span class="number">12</span>]= &#123;<span class="number">0xc0</span>,<span class="number">0xf9</span>,<span class="number">0xa4</span>,<span class="number">0xb0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xf8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>&#125;; <span class="comment">// 共阳 0~9</span></span><br><span class="line"><span class="keyword">int</span> counter=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> t=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> flag_set=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">(<span class="keyword">int</span> z)</span> </span>&#123; <span class="comment">// 延时函数</span></span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="comment">//for(i=z;i&gt;0;i--)</span></span><br><span class="line"><span class="comment">//for(j=0;j&lt;123;j++);</span></span><br><span class="line"><span class="keyword">for</span>(i=z*<span class="number">1000</span>; i&gt;<span class="number">0</span>; i--) _nop_(); <span class="comment">//1us</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">key</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">switch</span>(flag_set) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:<span class="comment">// 调整 小时 十位</span></span><br><span class="line"><span class="keyword">if</span>(p33==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p33==<span class="number">0</span>) &#123;</span><br><span class="line">hour+=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">if</span>(hour&gt;<span class="number">24</span>) hour%=<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p33==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(p34==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p34==<span class="number">0</span>) &#123;</span><br><span class="line">hour-=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">if</span>(hour&lt;<span class="number">0</span>) hour=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p34==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:<span class="comment">// 调整 小时 个位</span></span><br><span class="line"><span class="keyword">if</span>(p33==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p33==<span class="number">0</span>) &#123;</span><br><span class="line">hour++;</span><br><span class="line"><span class="keyword">if</span>(hour==<span class="number">24</span>) hour=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p33==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(p34==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p34==<span class="number">0</span>) &#123;</span><br><span class="line">hour--;</span><br><span class="line"><span class="keyword">if</span>(hour&lt;<span class="number">0</span>) hour=<span class="number">23</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p34==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:<span class="comment">// 调整 分钟 十位</span></span><br><span class="line"><span class="keyword">if</span>(p33==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p33==<span class="number">0</span>) &#123;</span><br><span class="line">minute+=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">if</span>(minute&gt;<span class="number">60</span>) minute%=<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p33==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(p34==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p34==<span class="number">0</span>) &#123;</span><br><span class="line">minute-=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">if</span>(minute&lt;<span class="number">0</span>) minute+=<span class="number">60</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p34==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:<span class="comment">// 调整 分钟 个位</span></span><br><span class="line"><span class="keyword">if</span>(p33==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p33==<span class="number">0</span>) &#123;</span><br><span class="line">minute++;</span><br><span class="line"><span class="keyword">if</span>(minute==<span class="number">60</span>) minute=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p33==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(p34==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p34==<span class="number">0</span>) &#123;</span><br><span class="line">minute--;</span><br><span class="line"><span class="keyword">if</span>(minute&lt;<span class="number">0</span>) minute=<span class="number">59</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p34==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">TMOD=<span class="number">0x01</span>;</span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line"></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">//T0 中断子开关</span></span><br><span class="line">TF0=<span class="number">0</span>;<span class="comment">//T0 溢出标志置 0</span></span><br><span class="line">TR0=<span class="number">1</span>;<span class="comment">// 打开计时器</span></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">// 中断总开关</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span>(p32==<span class="number">0</span>) &#123;</span><br><span class="line">delay(t);</span><br><span class="line"><span class="keyword">if</span>(p32==<span class="number">0</span>) &#123;</span><br><span class="line">flag_set++;</span><br><span class="line"><span class="keyword">if</span>(flag_set==<span class="number">4</span>) flag_set=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(p32==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">key();</span><br><span class="line"></span><br><span class="line">num[<span class="number">0</span>]=hour/<span class="number">10</span>;</span><br><span class="line">num[<span class="number">1</span>]=hour%<span class="number">10</span>;</span><br><span class="line">num[<span class="number">2</span>]=minute/<span class="number">10</span>;</span><br><span class="line">num[<span class="number">3</span>]=minute%<span class="number">10</span>;</span><br><span class="line"><span class="keyword">switch</span>(i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:P0=<span class="number">0xff</span>;p21=<span class="number">0</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[qian];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">0</span>;p23=<span class="number">1</span>;p24=<span class="number">1</span>;P0=led[bai];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">0</span>;p24=<span class="number">1</span>;P0=led[shi];i++;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:P0=<span class="number">0xff</span>;p21=<span class="number">1</span>;p22=<span class="number">1</span>;p23=<span class="number">1</span>;p24=<span class="number">0</span>;P0=led[ge];i=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">numr0</span><span class="params">()</span> interrupt 1 </span>&#123;</span><br><span class="line">TH0=<span class="number">0x3c</span>;<span class="comment">// 高八位时间初值</span></span><br><span class="line">TL0=<span class="number">0xb0</span>;<span class="comment">// 低八位时间初值</span></span><br><span class="line">counter++;</span><br><span class="line"><span class="keyword">if</span>(counter==<span class="number">20</span>*<span class="number">60</span>) &#123; <span class="comment">//1min 计时</span></span><br><span class="line">counter=<span class="number">0</span>;</span><br><span class="line">minute++;</span><br><span class="line"><span class="keyword">if</span>(minute==<span class="number">60</span>) minute=<span class="number">0</span>,hour++;</span><br><span class="line"><span class="keyword">if</span>(hour==<span class="number">24</span>) minute=<span class="number">0</span>,hour=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这学期我开了51单片机的课，之后会将我的一些作业发自己网站上，希望能有用。我使用的开发板核心是STC12C5A16S2，理论上以下代码是适用于8051内核单片机。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="学习笔记" scheme="https://huanz.top/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C语言" scheme="https://huanz.top/tags/C%E8%AF%AD%E8%A8%80/"/>
    
    <category term="单片机" scheme="https://huanz.top/tags/%E5%8D%95%E7%89%87%E6%9C%BA/"/>
    
    <category term="开源" scheme="https://huanz.top/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>毫无意义的吐槽</title>
    <link href="https://huanz.top/2021/make-complaints/"/>
    <id>https://huanz.top/2021/make-complaints/</id>
    <published>2021-08-19T12:31:03.000Z</published>
    <updated>2021-08-19T12:31:03.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> 应该是一篇语无伦次的吐槽吧，没多大意义，但不吐不快。</p></blockquote><p> 目前算是终于闲下来。前段时间有点搁置网站了，虽说隔三岔五会想到有网站，要写点儿什么，但有时候是实在没有码字的心思。果然，更网站、写东西也是需要毅力的。</p><span id="more"></span><ul><li><p> 六月的期末考试 </p><p> 对付期末考，实在像是一场“大战”。而我是属于那种完成作业即可，对课程不怎么深入学习的人，临近考前再突击一下。我知道自己英语成绩真的差劲，再怎么学也考不过那些绩点 90+ 的同学，索性“躺平”吧。实在很难想象，那些自律的同学，如何在大学还能做到 5 点起床，11 点回宿舍，一天高强度地学习。</p><p> 考试就像一场“豪赌”，最后的分数决定着我这一学期的好坏。就像拿一个高考的数字，便可以决定之前十几年的过程。而分数一旦及格，就好像在说，“这一学期我学过了这门课啦。”但真的学到了么？其中真正掌握的知识有多少？无从得知。不过，也不排除一部分课程真的水，到底有没有存在于大学课堂的意义。</p></li><li><p> 七月的小学期课程 </p><p> 第三学期，实在是磨人性子！我想知道，大学里为什么会有“三学期制”这种奇怪的设定，本来都期末考试完了，还要再待在学校一个月。有个朋友告诉我，他的专业的“第三学期”课程设置的是 C 语言，时间 20 多天，只学一门，小学期结束后考试。这难道是要这群零基础的学生，20 天快速掌握一本编程语言吗？实在离谱。不过是应付罢了，不挂科就谢天谢地了。</p><p> 一件“有趣”的事：暑假里，在校的人数不会很多，一位老师要做讲座，结果凑不够人数。这位老师找我们导员商量，要我们给充人头数。导员还不愿做得罪人的事，不直接出面，下派任务给班长；班长再下派寝室长；寝室长下派我们，还要每个宿舍出 3 人以上去参加。笑死，讲座内容专业不对口，天气还那么热，没几个愿意去。最后，我们宿舍一个没去。我的态度是不管谁的通知，若是无理的要求，就是不能无脑服从。是件小事，就算是我有些钻牛角尖吧。</p><p> 不过，并不是说老师的讲座不好，有些讲座还是可以去尝试听一听的，说不定有“宝藏”呢。就比如之前，本来是为了志愿学时去参加了一个读书分享会，闲着也是闲着，就报名参加了。主讲人是一位经济系的老师，他真的做到了把晦涩的经济学知识，通俗易懂又风趣幽默讲述给我们。这场讲座，既让我接触了从未接触的领域，也让我亲眼见识到了人格的魅力。我感觉，有点像讲高数的宋浩老师，不会让人枯燥，之后还会有收获，犹如一场酣畅淋漓的电影。对了，这位老师推荐了 《稀缺》和《思考，快与慢》这两本书，经济学著作，但我不是很感冒。</p></li></ul><p> 国内又爆发了已经不知道是第几轮疫情了，在家有自行隔离到现在。自己实在是无聊，想着来更篇文章。写着写着成了一片吐槽，不吐不快嘛。可能以后的我回来再看，就觉得幼稚了吧。行啦，今晚就先到这儿吧。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;应该是一篇语无伦次的吐槽吧，没多大意义，但不吐不快。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;目前算是终于闲下来。前段时间有点搁置网站了，虽说隔三岔五会想到有网站，要写点儿什么，但有时候是实在没有码字的心思。果然，更网站、写东西也是需要毅力的。&lt;/p&gt;</summary>
    
    
    
    <category term="日常" scheme="https://huanz.top/categories/%E6%97%A5%E5%B8%B8/"/>
    
    
    <category term="随笔" scheme="https://huanz.top/tags/%E9%9A%8F%E7%AC%94/"/>
    
    <category term="回忆" scheme="https://huanz.top/tags/%E5%9B%9E%E5%BF%86/"/>
    
  </entry>
  
  <entry>
    <title>C 语言备考笔记</title>
    <link href="https://huanz.top/2021/learn-c/"/>
    <id>https://huanz.top/2021/learn-c/</id>
    <published>2021-06-03T05:42:23.000Z</published>
    <updated>2021-06-14T05:42:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>这学期开了 C 语言课，马上也就要期末考试了，就把最近 <a href="https://pintia.cn/">PTA</a> 和 PPT 里的一些题整理一下下发到这里，非计算机专业，学术不精。</p><p><code>2021.9.10 更新</code></p><p>发现了阮一峰大佬写的好东西，想入门的可以参考这个，我的太烂了。<a href="https://www.ruanyifeng.com/blog/2021/09/c-language-tutorial.html">链接 1</a> <a href="https://wangdoc.com/clang/">链接 2</a></p><span id="more"></span><h1 id="结构"><a href="# 结构" class="headerlink" title="结构"></a><strong>结构 </strong></h1><p> 三种程序结构是 C 语言的基础了：顺序结构、选择结构(if 或 swich-default)、循环结构。</p><ul><li>C 语言程序是从源文件的第一条语句开始执行的。F</li><li>C 语言中的局部变量如果没有指定初值，则其初值自动设置为 0。F</li><li>变量的两个值 : 本身值和地址值都是可以改变的。F 地址是不变的</li><li>continue 只能用于循环体中。T</li><li>在 switch 语句中，每一个的 case 常量表达式的值可以相同。F</li><li>运行 <code>int i, a; i=(a=2*3,a*5), a+6;</code> 结果 i=30,a=6, 表达式的值 11。<br>逗号表达式的值等于最后一个表达式的值，是 C 语言中等级最低的运算符</li><li>若 x 为浮点型，则表达式 x=10/4 为（ ）。<br>A.2.5 B.2.0 C.2 D.3<br>答案是 A，区别于 10.0/5，先得结果为 2，再转换为浮点型是 2.0。</li><li>在 C 语言中，数字 029 是一个（ ）。<br>A. 八进制数 B. 十进制数 C. 十六进制数 D. 非法数 <br> 答案是 D，八进制里没有 9。</li><li>以下标识符中，不合法的是（ ）。<br>A.4d B._8_d C.Int D.key<br>答案是 A，标识符的第一位必须是字母或者下划线，不能是数字。</li><li>若有定义：double a＝22；int i＝0，k＝18；则不符合 C 语言规定的赋值语句是 ()<br>A) i＝(a＋k)&lt;＝(i＋k)    B) i＝a%11    C) i＝a<br> 答案 B，浮点数不能整除运算。</li><li>若变量已正确定义并赋值，符合 C 语言语法的表达式是 __.<br>A.a=2++    B.a=3,5    C.a=a+1=3    D.12.3%4</li><li>设有程序段 int m=20; while (m=0) m=m++; 则下面描述中正确的是（ ）。<br>A.while 循环执行 10 次    B. 循环是无限循环 <br>C. 循环体语句一次也不执行    D. 循环体语句执行一次<br> 答案 C。m=0 是赋值语句。</li><li>判断闰年 <code>leap=(year%4==0 &amp;&amp; year%100!=0) || (year % 400 == 0);</code></li></ul><h1 id="数组"><a href="# 数组" class="headerlink" title="数组"></a><strong>数组 </strong></h1><p> 数组最应注意初始化，别忘记定义数组个数。下面是一些不好记的库函数：</p><ul><li><strong>puts(str)</strong> 等于 printf(“%s”,ste)</li><li><strong>gets(str)</strong> 约等于 scanf(“%s”,str)<ul><li>gets()以回车结束输入，会舍弃最后的回车符。</li><li>scanf()以空白字符结束一次输入, 包括空格、回车等。</li><li>scanf()遇到回车结束后，不会舍弃’\n’, 而是留在了输入缓冲区中。</li></ul></li><li><strong>strcmp(str1,str2)</strong> 字符串比较函数<ul><li>str1 大于 2, 返回正值</li><li>逐位比较 ASCII 码，如 z&gt;a&gt;&gt;Z&gt;A&gt;&gt;9&gt;0</li><li>scanf 在读取非空白符之前会忽略回车.</li></ul></li><li>strcat(str1,str2)用连字符连接字符串</li><li>strcpy(str1,str2) 对 str1 作用，把 str2 复制到 str1</li><li>strlen(str) 测字符串长度函数</li><li>strlwr(str) 转化为小写函数</li><li>strupr(str) 转化为大写函数</li></ul><h1 id="函数"><a href="# 函数" class="headerlink" title="函数"></a><strong>函数</strong></h1><ul><li>判断一个素数</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">is</span><span class="params">(<span class="keyword">int</span> n)</span> <span class="comment">// 判断一个素数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,a=<span class="number">0</span>; <span class="comment">// 赋初值！！！</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=n<span class="number">-1</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            a++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">if</span>(a!=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="指针"><a href="# 指针" class="headerlink" title="指针"></a><strong>指针 </strong></h1><p> 指针相对于之前的知识还是有些难度的！</p><h2 id="判断题"><a href="# 判断题" class="headerlink" title="判断题"></a>判断题</h2><ul><li>直接访问就是直接利用变量的地址直接进行访问。T</li><li>char *s=”C Language”; 表示 s 是一个指向字符串的指针变量，把字符串的首地址赋予 s。T</li></ul><h2 id="单选题"><a href="# 单选题" class="headerlink" title="单选题"></a>单选题</h2><ul><li><p>设变量定义为 int a[2]={1,3}, <em>p=&amp;a[0]+1; ，则 </em>p 的值是()。<br> 答案为 3，*p=&amp;a[1]值为 3。</p></li><li><p>若变量已正确定义并且指针 p 已经指向某个变量 x，则 (<em>p)++ 相当于____。<br>A.p++    B.x++    C.</em>(p++)    D.&amp;x++<br> 答案为 B，*p=x，(*p)++ 自然等于 x++。</p></li><li><p>若有如下定义，则（ ）的值是 34。<br>int a[] = {5, 15, 34, 54, 14, 2, 52, 72};int *p = &amp;a[1];<br>A.p[1]    B.p[2]    C.p[0]    D.p[3]<br>p 指向 a[1]，p[1]的内容就是 a[2]了，也就是 34。</p></li><li><p>根据声明 int a[10], *p=a; ，下列表达式错误的是（ ）。<br>A.a[9]  B.p[5]  C.a++ D.*p++<br>答案为 C，p[5]就是 *(p+5), 也就是 a[5]。</p></li><li><p>若定义 pf 为指向 float 类型变量 f 的指针，下列语句中__是正确的。<br>A.float f, *pf = f; B.float f, *pf = &f;<br>C.float *pf = &amp;f, f;  D.float f, *pf =0.0;<br>答案为 B。float f, <em>pf = f; 含义同赋值语句</em>pf = f 不同，而是相当于 float f, *pf;pf = f;pf 被初始化指向地址值为 f 的指针，而地址值不可能是 float 的，这不合语法，所以出错。定义时初始化 float *pf = &f; 等价的语句是:float *pf;pf = &f; 是正确的。</p></li></ul><h1 id="后记"><a href="# 后记" class="headerlink" title="后记"></a><strong>后记 </strong></h1><p> 写个东西，排版有点费事，有这时间还不如滚去复习去~ </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;这学期开了C语言课，马上也就要期末考试了，就把最近&lt;a href=&quot;https://pintia.cn/&quot;&gt;PTA&lt;/a&gt;和PPT里的一些题整理一下下发到这里，非计算机专业，学术不精。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;2021.9.10更新&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;发现了阮一峰大佬写的好东西，想入门的可以参考这个，我的太烂了。&lt;a href=&quot;https://www.ruanyifeng.com/blog/2021/09/c-language-tutorial.html&quot;&gt;链接1&lt;/a&gt; &lt;a href=&quot;https://wangdoc.com/clang/&quot;&gt;链接2&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="学习笔记" scheme="https://huanz.top/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="经验分享" scheme="https://huanz.top/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
    
    <category term="C语言" scheme="https://huanz.top/tags/C%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>我的三体</title>
    <link href="https://huanz.top/2021/3body/"/>
    <id>https://huanz.top/2021/3body/</id>
    <published>2021-06-01T14:32:27.000Z</published>
    <updated>2021-06-03T02:32:27.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>为什么记下这样一篇文章？    这是计划的一部分。 :-)</p></blockquote><p>从五月以来，把三体给读完了，就想把自己读后一些小想法记下来。</p><span id="more"></span><h1 id="读三体的起因"><a href="# 读三体的起因" class="headerlink" title="读三体的起因"></a><strong>读三体的起因 </strong></h1><p> 在学校的时间里，其实很少会有时间去读书。就算有一些空闲的时间，真的很难会想到会拿这点儿时间去读书，毕竟现代人平时里娱乐的方式太多。</p><p>然而，在今年五一归家途中，要在坐高铁要好久，车上开手机流量也太不好使，就点开了之前下载的电子书，结果打开后就一发不可收了。</p><p>关于《三体》，从初中就听闻过它的大名，在去年暑假的闲暇时间里，已经把三体第一部读完。不过，第一本的具体内容也记不太清了，还依稀记得三体游戏、智子监控什么的。继续去读第二部，事实上并不影响接下来的阅读体验。在接下来的一个月里，断断续续读完了原著。随后，我还找到一些其他的相关作品来看，下面是一些我的简单感受。</p><h1 id="三体及其相关作品"><a href="# 三体及其相关作品" class="headerlink" title="三体及其相关作品"></a><strong>三体及其相关作品 </strong></h1><h2 id="三体原著"><a href="# 三体原著" class="headerlink" title="三体原著"></a> 三体原著 </h2><p> 原作多牛逼不用多说了。虽然书中有一些不符合科学角度的设定，但是它世界观和宏大的想象力实在厉害，一部比一部视角开阔，读后实在有一种豁然开朗的感觉。</p><h2 id="球形闪电"><a href="# 球形闪电" class="headerlink" title="球形闪电"></a>球形闪电</h2><p>《球形闪电》三体前传: 出现在三体中的有丁仪和球形闪电武器，不影响阅读原著。作者想象量子学的宏观现象，比如宏电子有足球那么大，还能被激发形成球形闪电；被球形闪电打击消失的生物会处于量子态；观察者的概念…都是让我印象深刻的！想象力赞！</p><h2 id="观想宇宙"><a href="# 观想宇宙" class="headerlink" title="观想宇宙"></a>观想宇宙 </h2><p> 同人小说：《三体 X·观想宇宙》，作者宝树。开始下载下来搁置了，字数没多少，后来一股气看完了。想象力上是可以的，内容文笔稍逊色。作为读完原作后的解馋是十分 OK 的，也有我喜欢的歌者片段。“同人逼死官方。”原著没续作了。</p><h2 id="我的三体"><a href="# 我的三体" class="headerlink" title="我的三体"></a>我的三体 </h2><p> 原创动画：真实展现技术爆炸！目前一共三部，<del>现在只看了罗辑传</del> , 后两部已刷完。剧情还原度好，动画赞！音乐赞！创新赞！</p><h2 id="水滴"><a href="# 水滴" class="headerlink" title="水滴"></a>水滴 </h2><p> 原创动画短片: 来自大刘的肯定，有些艺术，确实有那种宇宙宏大的感觉，推荐一看。</p><hr><h2 id="超新星纪元"><a href="# 超新星纪元" class="headerlink" title="超新星纪元"></a>超新星纪元</h2><p>《超新星纪元》与三体不相关，刘慈欣作品里顺便看的，设想还是很大胆的。不过，不太合我的口味。</p><h2 id="烧火工"><a href="# 烧火工" class="headerlink" title="烧火工"></a>烧火工 </h2><p> 作为一个童话故事，挺好的。里面描写鲸鱼的情节是在说日本么？</p><h1 id="后记"><a href="# 后记" class="headerlink" title="后记"></a><strong>后记 </strong></h1><p> 自己本来写这篇之前似乎心里有很多想说的，但鉴于自己表达能力不强，一坐在键盘前就什么不知道要说啥了了。只能把心中最直接的一些小想法记下来了，以后再想到什么再补充吧~</p><p>最后，就贴一个我最喜欢的关于歌者的片段作为结束吧~</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">歌者·时间童话 </span><br><span class="line"></span><br><span class="line"> 我看到了我的爱恋 </span><br><span class="line"> 我飞到她的身边 </span><br><span class="line"> 我捧出给她的礼物 </span><br><span class="line"> 那是一小块凝固的时间 </span><br><span class="line"> 时间上有美丽的条纹 </span><br><span class="line"> 摸起来像浅海的泥一样柔软 </span><br><span class="line"></span><br><span class="line"> 她把时间涂满全身 </span><br><span class="line"> 然后拉起我飞向存在的边缘 </span><br><span class="line"> 这是灵态的飞行 </span><br><span class="line"> 我们眼中的星星像幽灵 </span><br><span class="line"> 星星眼中的我们也像幽灵</span><br></pre></td></tr></table></figure><h1 id="相关链接"><a href="# 相关链接" class="headerlink" title="相关链接"></a><strong>相关链接</strong></h1><ol><li><a href="https://zh.moegirl.org.cn/index.php?title=%E4%B8%89%E4%BD%93/%E8%A1%8D%E7%94%9F%E4%BD%9C%E5%93%81&variant=%E4%B8%89%E4%BD%93&mobileaction=toggle_view_desktop">萌娘百科 - 三体衍生作品</a></li><li> <a href="https://zh.wikipedia.org/w/index.php?title=%E5%A7%AC%E5%B0%91%E4%BA%AD&action=edit&redlink=1">小姬 </a>. <a href="https://web.archive.org/web/20130116034939/http://www.guokr.com/blog/83809/"> 刘慈欣写给我的童话</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;为什么记下这样一篇文章？    这是计划的一部分。 :-)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;从五月以来，把三体给读完了，就想把自己读后一些小想法记下来。&lt;/p&gt;</summary>
    
    
    
    <category term="读书" scheme="https://huanz.top/categories/%E8%AF%BB%E4%B9%A6/"/>
    
    
    <category term="随笔" scheme="https://huanz.top/tags/%E9%9A%8F%E7%AC%94/"/>
    
    <category term="阅读分享" scheme="https://huanz.top/tags/%E9%98%85%E8%AF%BB%E5%88%86%E4%BA%AB/"/>
    
  </entry>
  
  <entry>
    <title>机械制图初体验</title>
    <link href="https://huanz.top/2021/solidworks/"/>
    <id>https://huanz.top/2021/solidworks/</id>
    <published>2021-05-29T12:30:12.000Z</published>
    <updated>2021-06-10T04:30:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近在做制图课程设计，用 Solidworks 出工程图。Solidworks(简称 SW), 是机械 3D 制图入门软件之一。在本学期，我们的课程设计要求使用 Solidworks 画铣刀头的装配图。</p><span id="more"></span><h1 id="软件的使用"><a href="# 软件的使用" class="headerlink" title="软件的使用"></a>软件的使用 </h1><p> 说是初体验，其实也不算是啦，SW 已经自己练习小半个学期了，只不过这次出图是要交给老师的。另外，我使用的是 2020 版，虽然不知道 2020 版有什么新功能。不过从学习软件的经验上，掌握任何一个版本是完全够用的，对一个版本熟练运用即可。</p><h1 id="国标件下载"><a href="# 国标件下载" class="headerlink" title="国标件下载"></a>国标件下载 </h1><p> 除了一些非标件需要我们自己按照图纸画，国标件是都可以通过在网络下载解决的。Solidworks 内置国标件，但就操作上而言，感觉操作起来不太优雅。从一个 UP 主学来的：用 <strong>今日制造</strong> 这个软件。</p><p>吐槽一下，官网的下载界面一股广告风，软件在逻辑上感觉也是面对专业人士的工作流，第一次用看起来会有些凌乱，有点像现在的 WPS。但瑕不掩瑜，就「下载国标件」这个功能上，还是做的比较优秀的。</p><ul><li>软件里的国标件会根据国家标准进行更新，这是我比较看好的。</li><li>提供.sldprt 和.step 格式下载，下载速度尚可。</li><li>部分甚至还选不同的材质和表面处理方式。</li></ul><h1 id="字体问题"><a href="# 字体问题" class="headerlink" title="字体问题"></a>字体问题 </h1><p> 教材书里规定，数字标注使用所谓 B 型字体，ISOGP 系列字体是比较接近的，国标规定的中文字体使用长仿宋体。当然实际作图中文字只要清晰可辨即可。做完图，还出了一点小插曲，用 Solidworks 生成 PDF 时软件出现了报错，安装 Arial Unicode MS 这个字体可解决。</p><ul><li>百度网盘：<a href="https://pan.baidu.com/s/1T1nL63_jp5UxzobV5RdjTQ">🔗地址链接</a> 提取码:  tsfr </li><li>阿里云盘：<a href="https://www.aliyundrive.com/s/nS86YMDaoLR">🔗arial-unicode-ms.ttf</a>     <a href="https://www.aliyundrive.com/s/Yh7HBLJgPMo">🔗LFSwm7.ttf</a>    <a href="https://www.aliyundrive.com/s/J3xL1CMEDk6">🔗SOCP.ttf</a></li></ul><h1 id="图纸导出"><a href="# 图纸导出" class="headerlink" title="图纸导出"></a>图纸导出 </h1><p> 过了几天，我又回来了。这次谈谈这几天的一个小经验。画图肯定是要最后导出，打印给人看的。推荐使用 Solidworks 出图时使用“打印”功能，不推荐使用“另存为”，否则导出 PDF 会出现字体偏移，强迫症表示很不舒服~</p><p>这个“打印”功能不是真的用打印机，而是使用自带 Mincrosoft Print to PDF，可以理解成一个虚拟打印机，间接实现导出 PDF 文件。通过“打印”导出的 PDF 和软件里画的图一致，实测不会出现文字偏移的问题。</p><p>另外，在“打印”功能跳出的菜单里，在“页面设置”里，把“工程图颜色”改为“黑白”，可以解决工程图里有些线和字颜色过浅的问题。</p><h1 id="顺利完成"><a href="# 顺利完成" class="headerlink" title="顺利完成"></a>顺利完成 </h1><p> 解决完字体问题后顺利出图，好耶！</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;最近在做制图课程设计，用Solidworks出工程图。Solidworks(简称SW),是机械3D制图入门软件之一。在本学期，我们的课程设计要求使用Solidworks画铣刀头的装配图。&lt;/p&gt;</summary>
    
    
    
    <category term="学习笔记" scheme="https://huanz.top/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="随笔" scheme="https://huanz.top/tags/%E9%9A%8F%E7%AC%94/"/>
    
    <category term="经验分享" scheme="https://huanz.top/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
    
  </entry>
  
  <entry>
    <title>战略转移 Cloudflare</title>
    <link href="https://huanz.top/2021/move-to-cloudflare/"/>
    <id>https://huanz.top/2021/move-to-cloudflare/</id>
    <published>2021-05-23T05:23:10.000Z</published>
    <updated>2021-06-08T05:23:10.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.cloudflare.com/zh-cn/">Cloudflare Pages</a>是一个替换 GitHub Pages 的方案，下面我将简单描述我把博客从 Github Pages 迁移到 Cloudflare Pages 的过程。</p><h1 id="缘起"><a href="# 缘起" class="headerlink" title="缘起"></a>缘起 </h1><p> 在浏览本 Hexo 主题的作者的博客——<a href="https://candinya.com/">糖菓·部落 </a> 时，发现他的博客没有托管在 <a href="https://github.io" target="_blank">Github Pages</a> 上，而是使用了<a href="https://pages.cloudflare.com" target="_blank">Cloudflare Pages</a>。虽然我有了解，现在国内外有很多静态网页托管平台，但 GitHub Pages 在各方面应该算是一个首选。（尤其对于我这种新手）</p><span id="more"></span><p>与此同时，我之前在 <a href="https://ziyuan.baidu.com/"> 百度站长平台 </a> 上提交的博客网址至今一个索引量也没有。虽然我的网站刚刚开始不久，但没有一个索引量，使我开始怀疑是不是哪里出了问题。</p><p>于是，我开始在网上搜索“博客的搜索引擎收录”，偶然间发现了这么一篇文章 <a href="https://zpjiang.me/2020/01/15/let-baidu-index-github-page/"> 解决百度爬虫无法爬取 Github Pages 个人博客的问题</a>。</p><blockquote><p><strong>百度爬虫被拒绝访问</strong></p><p>然而，2015 年，因为一些不能细说的原因，Github 开始拒绝百度爬虫的访问，直接返回 403。官方给出原因是，百度爬虫爬得太狠，影响了 Github Page 服务的正常使用。这就导致了，但凡在 Github Pages 搭建的个人博客，都无法被百度收录。</p></blockquote><p>文中给出的解决方案有：</p><ul><li> CDN 解决最后一公里的资源分发，但无法完美解决问题，尤其对小流量的个人博客。</li><li> Coding Pages 做镜像站，但访问时会先出现跳转页面，导致百度爬虫无法正常收录。</li><li> 使用 <a href="https://zeit.co/"> zeit.co </a> 提供的静态资源 hosting 服务，本质上他们提供了 Storage+CDN+DNS 这一套完整服务。</li></ul><h1 id="解决问题"><a href="# 解决问题" class="headerlink" title="解决问题"></a>解决问题 </h1><p> 受文章 <a href="https://zpjiang.me/2020/01/15/let-baidu-index-github-page/"> 解决百度爬虫无法爬取 Github Pages 个人博客的问题 </a> 的启发，我想 <a href="https://pages.cloudflare.com" target="_blank">Cloudflare Pages</a> 是不是也能解决相同的问题呢。</p><p>于是在网上继续搜索，找到以下博文：</p><ul><li><a href="https://yanqiyu.info/2021/03/06/cloudflare-pages/">迁移博客到 Cloudflare Pages</a></li><li><a href="https://blog.794td.me/archives/14.html">利用 CloudFlare Pages 搭建一个 Hexo 博客</a></li></ul><p>我了解到，<a href="https://pages.cloudflare.com" target="_blank">Cloudflare Pages 项目 </a> 现在处于公测阶段 (Public Beta)，只需要注册一个 CloudFlare 账户。免费套餐单月可部署 500 次，无限流量，足够了。Cloudflare Pages 依托于成立于 2009 年 7 月的网络服务提供商<a href="https://www.cloudflare.com/zh-cn/">Cloudflare, Inc.</a>，因此可以提供稳定的静态网页托管服务。</p><blockquote><p> “ Cloudflare 家大业大，并且是专门做网络服务的，做网页托管应该不会太菜吧。 ”</p></blockquote><p>说实话，转移到 <a href="https://pages.cloudflare.com" target="_blank">Cloudflare Pages</a> 能不能解决百度收录的问题，我也不知道。但单这项服务来说，它也不差呀~</p><h1 id="转移部署"><a href="# 转移部署" class="headerlink" title="转移部署"></a>转移部署 </h1><p> 不行，我要给我的博客最好的环境，折腾开始！</p><p>当然，如果像我一样，已有 GitHub Pages 搭建好的博客，单纯想要把把托管转移到 Cloudflare Pages，这个过程是不难的。无需改动 GitHub 相关的设置，相当于一个锦上添花的过程，这样也方便我们随时回退 GitHub Pages。</p><p>下面我们只需在 <a href="https://pages.cloudflare.com/">Pages</a> 注册好账号，点击那个大大的黄色的 Get Started 按钮，按照指引授权 GitHub 权限，选择构建使用的仓库(就是 GitHub Pages 的仓库地址)。设置构建的命令，我不太懂，也没有改动，最终就部署完成了。</p><p>【 <strong>部署完成</strong> 】&gt;&gt; <a href="https://gone1724-github-io.pages.dev/">https://gone1724-github-io.pages.dev</a></p><p>我实测从上传 Github 完成，到 Cloudflare 部署完成用时在 50s 左右，并且站点 IP 支持 IPV6！</p><h1 id="域名解析"><a href="# 域名解析" class="headerlink" title="域名解析"></a>域名解析 </h1><p> 我的域名 <a href="https://huanz.top/">huanz.top</a> 之前托管在<a href="https://dnspod.cn/">DNSPod</a>。由于 Cloudflare 也提供了 DNS 解析服务，就顺便也试用了一下它的免费的解析套餐。</p><p>最近发现如果使用自己的域名，就必须使用 Cloudflare 提供的 DNS 解析服务欸，可恶。</p><h1 id="部署原理"><a href="# 部署原理" class="headerlink" title="部署原理"></a>部署原理 </h1><p> 以下是我的理解：</p><ul><li>电脑本地 <code>Hexo g -d</code> 后，把生成好的静态文件上传到 GitHub 远程仓库里。</li><li>Cloudflare Pages 服务会自动访问 GitHub 仓库，拉取网页文件。</li><li>Cloudflare 在自己的主机上生成一个网站，最后完成部署。</li><li>此时，我的博客网站已完全脱离 GitHub/GitHub Pages，在访客访问 <a href="https://huanz.top/">huanz.top</a> 时就会解析到 Cloudflare 的主机。<ul><li>同理，GitHub Pages 则是在 GitHub 自己主机上生成，主机在国外。</li><li><del>Cloudflare Pages 在国内有主机，访问速度会较快。（官网介绍）</del></li><li>从测试来看，Cloudflare 主机好像还是是美国节点。</li><li>Cloudflare Pages 二级域名速度测试：<a href="http://ping.chinaz.com/gone1724-github-io.pages.dev">Ping 测试 </a> <a href="https://www.ping.cn/http/gone1724-github-io.pages.dev"> 网站测速 1</a> <a href="http://tool.chinaz.com/speedtest/gone1724-github-io.pages.dev">网站测速 2</a></li></ul></li></ul><h1 id="更多细节"><a href="# 更多细节" class="headerlink" title="更多细节"></a>更多细节 </h1><p> 更多细节上的疑问，欢迎留言交流~</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.cloudflare.com/zh-cn/&quot;&gt;Cloudflare Pages&lt;/a&gt;是一个替换GitHub Pages的方案，下面我将简单描述我把博客从Github Pages迁移到Cloudflare Pages的过程。&lt;/p&gt;
&lt;h1 id=&quot;缘起&quot;&gt;&lt;a href=&quot;#缘起&quot; class=&quot;headerlink&quot; title=&quot;缘起&quot;&gt;&lt;/a&gt;缘起&lt;/h1&gt;&lt;p&gt;在浏览本Hexo主题的作者的博客——&lt;a href=&quot;https://candinya.com/&quot;&gt;糖菓·部落&lt;/a&gt;时，发现他的博客没有托管在&lt;a href=&quot;https://github.io&quot; target=&quot;_blank&quot;&gt;Github Pages&lt;/a&gt;上，而是使用了&lt;a href=&quot;https://pages.cloudflare.com&quot; target=&quot;_blank&quot;&gt;Cloudflare Pages&lt;/a&gt;。虽然我有了解，现在国内外有很多静态网页托管平台，但GitHub Pages在各方面应该算是一个首选。（尤其对于我这种新手）&lt;/p&gt;</summary>
    
    
    
    <category term="建站日志" scheme="https://huanz.top/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
    <category term="经验分享" scheme="https://huanz.top/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
    
    <category term="Hexo" scheme="https://huanz.top/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>开启站长统计</title>
    <link href="https://huanz.top/2021/site-statistics/"/>
    <id>https://huanz.top/2021/site-statistics/</id>
    <published>2021-05-20T13:40:00.000Z</published>
    <updated>2021-06-01T10:51:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>经过今天的折腾，本站已成功开启 <strong>站长统计</strong> 功能。</p><p>服务依托于 <a href="https://www.umeng.com/">cnzz.com</a>，访问<a href="https://new.cnzz.com/v1/login.php?siteid=1279942268"> 站长统计 </a> 即可查看我站统计数据。</p><span id="more"></span><hr><h1 id="如何添加 cnzz-com 站长统计代码到网页上？"><a href="# 如何添加 cnzz-com 站长统计代码到网页上？" class="headerlink" title="如何添加 cnzz.com 站长统计代码到网页上？"></a>如何添加 cnzz.com 站长统计代码到网页上？</h1><p>据 cnzz 网站介绍，将统计代码粘贴到您网站所有页面的 <code>&lt;/body&gt;</code> 前，添加成功后开始统计。</p><p>同时 cnzz 网站说明，<em>加载 CNZZ 统计代码不会影响您网页的正常显示和加载速度。</em></p><h1 id="如何将站长统计的文字 - 图片隐藏？"><a href="# 如何将站长统计的文字 - 图片隐藏？" class="headerlink" title="如何将站长统计的文字 / 图片隐藏？"></a>如何将站长统计的文字 / 图片隐藏？</h1><p>在统计代码 javascript 中的 ducument.write(unescape(“%3Cspan 和 id=’cnzz_stat_icon’中间加上 <code>style=&#39;display:none</code> 即可。</p><p>如本网站的代码实现如下。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.write(<span class="built_in">unescape</span>(<span class="string">&quot;%3Cspan style=&#x27;display:none;&#x27; id=&#x27;cnzz_stat_icon_1279942268&#x27;%3E%3C/span%3E%3Cscript src=&#x27;https://v1.cnzz.com/z_stat.php%3Fid%3D1279942268&#x27; type=&#x27;text/javascript&#x27;%3E%3C/script%3E&quot;</span>));</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="本主题 KRATOS-REBIRTH 是如何实现的？"><a href="# 本主题 KRATOS-REBIRTH 是如何实现的？" class="headerlink" title="本主题 KRATOS:REBIRTH 是如何实现的？"></a>本主题 <a href="https://github.com/Candinya/Kratos-Rebirth">KRATOS:REBIRTH</a> 是如何实现的？</h1><p>本博客使用 <a href="https://hexo.io/">Hexo</a> 搭建，几乎无需触碰底层代码，当仍可通过修改主题文件对网站实现自定义。我当前使用的主题 <a href="https://github.com/Candinya/Kratos-Rebirth">KRATOS:REBIRTH</a> 默认支持在页尾添加统计代码。</p><p>具体位置在 <code>themes\Kratos-Rebirth\_config.yml</code> 文件中 <code># Global 全局配置</code> 的<code>site_analytics:</code>。</p><h1 id="我做了什么？"><a href="# 我做了什么？" class="headerlink" title="我做了什么？"></a>我做了什么？</h1><p>通过下面的操作，当我更换域名，只需修改在配置文件中统计代码 id 号即可。</p><ol><li>在 <code>themes\Kratos-Rebirth\_config.yml</code> 中添加一个自定义项如下。</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">site_analytics_cnzz:</span> <span class="number">1279942268</span> <span class="comment"># 输入 www.CNZZ.com 的站长统计 id 号，默认在网页中隐藏</span></span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>themes\Kratos-Rebirth\layout\_partial\head.ejs</code> 文件中，在文本最后， <code>&lt;/body&gt;</code>之前，添加如下代码, 自定义项与前面对应。</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (theme.site_analytics_cnzz) &#123; %&gt;<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.write(<span class="built_in">unescape</span>(<span class="string">&quot;%3Cspan style=&#x27;display:none;&#x27; id=&#x27;cnzz_stat_icon_&lt;%- theme.site_analytics_cnzz %&gt;&#x27;%3E%3C/span%3E%3Cscript src=&#x27;https://v1.cnzz.com/z_stat.php%3Fid%3D&lt;%- theme.site_analytics_cnzz %&gt;&#x27; type=&#x27;text/javascript&#x27;%3E%3C/script%3E&quot;</span>));</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;经过今天的折腾，本站已成功开启 &lt;strong&gt;站长统计&lt;/strong&gt; 功能。&lt;/p&gt;
&lt;p&gt;服务依托于&lt;a href=&quot;https://www.umeng.com/&quot;&gt;cnzz.com&lt;/a&gt;，访问&lt;a href=&quot;https://new.cnzz.com/v1/login.php?siteid=1279942268&quot;&gt;站长统计&lt;/a&gt;即可查看我站统计数据。&lt;/p&gt;</summary>
    
    
    
    <category term="建站日志" scheme="https://huanz.top/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
    <category term="经验分享" scheme="https://huanz.top/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
    
    <category term="Hexo" scheme="https://huanz.top/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>一起来讨论吧</title>
    <link href="https://huanz.top/2021/waline/"/>
    <id>https://huanz.top/2021/waline/</id>
    <published>2021-05-20T04:12:50.000Z</published>
    <updated>2021-06-18T02:51:41.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://waline.js.org/">Waline</a>是一款基于 Valine 衍生的简洁、安全的评论系统。<del>经过昨天的昨天的折腾，本站已成功启用主题内置 <strong>Waline</strong> 评论区功能，欢迎在本站文章下评论区留言。</del></p><span id="more"></span><p>使用 <strong>Waline</strong> 的过程虽然比 <strong>Valine</strong> 稍复杂。但 <strong>Waline</strong> 不仅是一个评论系统，还具有文章阅读量统计功能。同时，也有一个简单的后端管理系统，方便进行内容管理，具体更多功能可参见 <a href="https://waline.js.org/get-started.html"> 官网文档</a>。</p><p>总之就是十分强大！</p><hr><p>2020/6/18 更新：评论区暂关闭。</p><p>Waline 无疑是一个好的开源项目，毕竟现在也没人给咱评论，同时让博客保持简洁，就决定先关闭了。想与我交流？网站里可以找到联系方式哦~</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://waline.js.org/&quot;&gt;Waline&lt;/a&gt;是一款基于 Valine 衍生的简洁、安全的评论系统。&lt;del&gt;经过昨天的昨天的折腾，本站已成功启用主题内置&lt;strong&gt;Waline&lt;/strong&gt;评论区功能，欢迎在本站文章下评论区留言。&lt;/del&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="建站日志" scheme="https://huanz.top/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
    <category term="Hexo" scheme="https://huanz.top/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>小单车，我们走</title>
    <link href="https://huanz.top/2021/smartcar-k/"/>
    <id>https://huanz.top/2021/smartcar-k/</id>
    <published>2021-05-18T10:51:41.000Z</published>
    <updated>2021-06-18T07:51:41.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>2021 智能车单车组开源。</p></blockquote><p> 今天就拿 GitHub 的一个项目水一篇~</p><p> 本人参与硬件部分，不过也是新手。把自己的硬件部分开源，希望和大家一起交流进步。好多资料网络上都可以查得到的，可以认为这里做的是硬件方案的分享。</p><span id="more"></span><p> 本篇博客更新截至 <code>2021.6.18</code>，最新请前往 <a href="https://github.com/gone1724/Smartcar_K">GitHub 项目地址 </a>。</p><hr><h1 id="2021-3-20"><a href="#2021-3-20" class="headerlink" title="2021-3-20"></a>2021-3-20</h1><p> 先上传前期的一套方案的原理图，目前遇到的问题是主板模块下载程序成功率较低。<br> 可能是 MCU 供电和 USB 转 TTL 电压因为分开供电，电压不稳造成的。</p><h1 id="2021-3-22"><a href="#2021-3-22" class="headerlink" title="2021-3-22"></a>2021-3-22</h1><p> 究极一体板方案！（bushi）这是最近尝试的一体板方案，包括全桥驱动芯片和四电感运放部分，希望不要出问题。</p><h1 id="2021-4-7"><a href="#2021-4-7" class="headerlink" title="2021-4-7"></a>2021-4-7</h1><p>MCU V3.1 的驱动部分，8V 稳压好像只能到 7.1V。</p><h1 id="2021-5-17"><a href="#2021-5-17" class="headerlink" title="2021-5-17"></a>2021-5-17</h1><p> 把主板上稳压去掉了，用的之前的驱动板驱动，几个月了，稳的一批。<br> 不过我现在的 2350 运放又出问题了，之前还能用，现在咋用不了了，气！</p><h1 id="2021-5-20"><a href="#2021-5-20" class="headerlink" title="2021-5-20"></a>2021-5-20</h1><p> 运放没问题，是电磁杆焊的有问题，FPC 好难焊得好啊。</p><h1 id="2021-6-6"><a href="#2021-6-6" class="headerlink" title="2021-6-6"></a>2021-6-6</h1><p> 只能暂时说再见了！我们最后代码已经上传，只做到了单车的直线前进。不能转圈的原因，学长说可能滤波效果没做好之类，不管了。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;2021智能车单车组开源。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;今天就拿GitHub的一个项目水一篇~&lt;/p&gt;
&lt;p&gt;本人参与硬件部分，不过也是新手。把自己的硬件部分开源，希望和大家一起交流进步。好多资料网络上都可以查得到的，可以认为这里做的是硬件方案的分享。&lt;/p&gt;</summary>
    
    
    
    <category term="智能车" scheme="https://huanz.top/categories/%E6%99%BA%E8%83%BD%E8%BD%A6/"/>
    
    
    <category term="经验分享" scheme="https://huanz.top/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
    
    <category term="开源" scheme="https://huanz.top/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>在路上，忽然想到</title>
    <link href="https://huanz.top/2021/one-occurrent/"/>
    <id>https://huanz.top/2021/one-occurrent/</id>
    <published>2021-05-17T14:22:45.000Z</published>
    <updated>2021-05-17T14:51:41.000Z</updated>
    
    <content type="html"><![CDATA[<p> 晚上自习完，走在路上忽然想到一件事，再不来过来记录一下就忘了。17 年暑假，曾经搭建过的第一个博客网站：<a href="https://waguansi.xyz/">waguansi.xyz（已失效）</a>。那时是用 wordpress 搭建，主机商的虚拟主机支持一键安装博客系统，所以不用特别折腾。</p><span id="more"></span><p> 之前和现在一样，也是用的 namesilo 买域名加 DNSPod 解析。大概写了一年，到后期就鸽了，一年后主机到期就没再续了。</p><p> 幸运的是，当时把博客内容一片一片复制保存下来了。之后的一段时间，虽然网站没了，保留下来的那个文本还是被我当成日记在接着写。啥时候迁移一部分过来，这样我的博客时间就能增加了~</p><p> 是啊，还好，现在捡起来了。</p><p><img src="https://i.loli.net/2021/05/19/W3YgwRSyvbG2cjn.png" alt="邮件截图.png"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;晚上自习完，走在路上忽然想到一件事，再不来过来记录一下就忘了。17年暑假，曾经搭建过的第一个博客网站：&lt;a href=&quot;https://waguansi.xyz/&quot;&gt;waguansi.xyz（已失效）&lt;/a&gt;。那时是用wordpress搭建，主机商的虚拟主机支持一键安装博客系统，所以不用特别折腾。&lt;/p&gt;</summary>
    
    
    
    <category term="建站日志" scheme="https://huanz.top/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
    <category term="随笔" scheme="https://huanz.top/tags/%E9%9A%8F%E7%AC%94/"/>
    
    <category term="回忆" scheme="https://huanz.top/tags/%E5%9B%9E%E5%BF%86/"/>
    
  </entry>
  
  <entry>
    <title>新域名，启动！</title>
    <link href="https://huanz.top/2021/first-domain/"/>
    <id>https://huanz.top/2021/first-domain/</id>
    <published>2021-05-16T06:30:06.000Z</published>
    <updated>2021-05-16T10:51:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>购买了一年的域名：<a href="https://huanz.top/">huanz.top</a>，选了好久，最终决定用付费的，省心。</p><span id="more"></span><p><strong>.top</strong> 域名首年费用 0.99 刀，<a href="https://www.namesilo.com/">namesilo</a>支持微信支付，最后结算时支付了人民币 6.37 元。</p><p>域名使用腾讯系的 <a href="https://www.dnspod.cn/">DNSPod</a> 解析<a href="https://github.com/gone1724/gone1724.github.io" title="项目地址">gone1724.github.io</a>，DNSPod 好久没登陆了，没想到它还在解析着以前申请过的一个 <strong>.tk</strong> 域名。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;购买了一年的域名：&lt;a href=&quot;https://huanz.top/&quot;&gt;huanz.top&lt;/a&gt;，选了好久，最终决定用付费的，省心。&lt;/p&gt;</summary>
    
    
    
    <category term="建站日志" scheme="https://huanz.top/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
    <category term="经验分享" scheme="https://huanz.top/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
    
  </entry>
  
  <entry>
    <title>Hello World!</title>
    <link href="https://huanz.top/2021/hello-world/"/>
    <id>https://huanz.top/2021/hello-world/</id>
    <published>2021-05-15T02:50:43.000Z</published>
    <updated>2021-06-08T10:51:41.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第一篇文章。"><a href="# 第一篇文章。" class="headerlink" title="第一篇文章。"></a> 第一篇文章。</h1><span id="more"></span>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;第一篇文章。&quot;&gt;&lt;a href=&quot;#第一篇文章。&quot; class=&quot;headerlink&quot; title=&quot;第一篇文章。&quot;&gt;&lt;/a&gt;第一篇文章。&lt;/h1&gt;</summary>
    
    
    
    
  </entry>
  
</feed>
